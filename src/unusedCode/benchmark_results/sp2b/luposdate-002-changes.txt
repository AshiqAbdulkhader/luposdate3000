rewrite of all operators to use iterators everywhere
