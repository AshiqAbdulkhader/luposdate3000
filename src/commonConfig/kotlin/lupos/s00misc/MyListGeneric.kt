package lupos.s00misc

import lupos.s00misc.Coverage

/* this File is autogenerated by generate-buildfile.kts */
/* DO NOT MODIFY DIRECTLY */
/* Substitutions :: Generic,<Generic>,<Generic>,Array<Any?>,{null} */
class MyListGeneric<Generic> {
    @JvmField
    var size = 0
    @JvmField
    var capacity = 10
    @JvmField
    var data: Array<Any?>

    inline fun reserve(capacity: Int) {
        if (this.capacity < capacity) {
            this.capacity = capacity
            val tmp = Array<Any?>(capacity) { null }
            data.copyInto(tmp)
            data = tmp
        }
    }

    constructor() {
        data = Array<Any?>(capacity) { null }
    }

    constructor(value: Generic) {
        data = Array<Any?>(capacity) { null }
        data[size++] = value
    }

    constructor(initialCapacity: Int, init: (Int) -> Generic) {
        capacity = initialCapacity
        size = capacity
        data = Array<Any?>(capacity) { init(it) }
    }

    fun clear() {
        size = 0
    }

    fun add(value: Generic) {
        if (size + 1 >= capacity) {
            reserve(capacity * 2)
        }
        data[size++] = value
    }

    inline operator fun get(idx: Int) = data.get(idx) as Generic
    inline operator fun set(idx: Int, key: Generic) = data.set(idx, key)
    fun remove(value: Generic): Boolean {
        for (idx in 0 until size) {
            if (data[idx] == value) {
                removeAt(idx)
                return true
            }
        }
        return false
    }

    fun removeAt(idx: Int): Generic {
        val res = data[idx]
        require(idx < size)
        for (i in idx until size) {
            data[i] = data[i + 1]
        }
        size--
        return res as Generic
    }

    fun add(idx: Int, value: Generic) {
        if (size + 1 >= capacity) {
            reserve(capacity * 2)
        }
        if (idx < size) {
            size++
            for (i in size downTo idx + 1) {
                data[i] = data[i - 1]
            }
            data[idx] = value
        } else {
            data[size++] = value
        }
    }

    inline operator fun iterator() = MyListGenericIterator(this)
    class MyListGenericIterator<Generic>(@JvmField val data: MyListGeneric<Generic>) : Iterator<Generic> {
        var index = 0
        override fun hasNext() = index < data.size
        override fun next() = data.data[index++] as Generic
    }
}
